
<!DOCTYPE html>
<html>
<head>
    <title>Penetration Test Report - DVWA IDOR</title>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: #1e1e1e;
            color: #d4d4d4;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1, h2, h3 {
            color: #569cd6;
            border-bottom: 2px solid #569cd6;
            padding-bottom: 5px;
        }
        h1 {
            text-align: center;
            font-size: 2.5em;
        }
        .header {
            background-color: #2d2d30;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .section {
            background-color: #2d2d30;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .code-block {
            background-color: #1e1e1e;
            border: 1px solid #3c3c3c;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
            margin: 10px 0;
        }
        .vulnerable {
            color: #f48771;
            font-weight: bold;
        }
        .safe {
            color: #73c991;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #3c3c3c;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #252526;
            color: #569cd6;
        }
        tr:nth-child(even) {
            background-color: #2d2d30;
        }
        .payload {
            color: #d7ba7d;
        }
        .highlight {
            background-color: #264f78;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .risk-high {
            background-color: #3a1a1a;
            border-left: 4px solid #f48771;
            padding: 10px;
            margin: 10px 0;
        }
        .disclaimer {
            background-color: #3a3a1a;
            border: 1px solid #d7ba7d;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Penetration Test Report</h1>
            <p><strong>Target:</strong> http://localhost/dvwa/vulnerabilities/authbypass/</p>
            <p><strong>Date:</strong> 2025-08-03 18:35:31</p>
            <p><strong>Author:</strong> Automated Security Agent</p>
            <p><strong>Classification:</strong> UNCLASSIFIED</p>
        </div>

        <div class="section">
            <h2>Executive Summary</h2>
            <p>This penetration test identified critical Insecure Direct Object Reference (IDOR) vulnerabilities in the Damn Vulnerable Web Application (DVWA). Testing was performed by logging in as a regular user (gordonb/abc123) and manipulating the userid parameter to access unauthorized user data.</p>
            
            <div class="disclaimer">
                <strong>Educational Context:</strong> This test was conducted on DVWA, an educational application designed to demonstrate security vulnerabilities. The findings represent legitimate IDOR vulnerabilities but in an educational context.
            </div>
            
            
            <div class="risk-high">
                <strong>Risk Level:</strong> HIGH
            </div>
            <p>Critical Insecure Direct Object Reference (IDOR) vulnerabilities were identified that allow unauthorized access to user data through direct manipulation of object references.</p>
            
        </div>

        <div class="section">
            <h2>Vulnerability Details</h2>
            <table>
                <tr><th>Category</th><th>Details</th></tr>
                <tr><td><strong>Name</strong></td><td>Insecure Direct Object Reference (IDOR)</td></tr>
                <tr><td><strong>OWASP ID</strong></td><td>OTG-AUTHZ-004</td></tr>
                
                <tr><td><strong>Risk Level</strong></td><td><span class="vulnerable">HIGH</span></td></tr>
                
                <tr><td><strong>URL</strong></td><td>http://localhost/dvwa/vulnerabilities/authbypass/</td></tr>
                <tr><td><strong>Description</strong></td><td>The application uses direct object references to access user data without proper authorization checks, allowing attackers to manipulate the userid parameter to access unauthorized user information.</td></tr>
                <tr><td><strong>Impact</strong></td><td>User enumeration, unauthorized access to sensitive user data, privilege escalation potential, and violation of data confidentiality.</td></tr>
                <tr><td><strong>Remediation</strong></td><td>Implement proper server-side authorization checks, use indirect object references, validate user permissions, and apply the principle of least privilege.</td></tr>
            </table>
        </div>

        <div class="section">
            <h2>Technical Analysis</h2>
            <h3>Testing Methodology</h3>
            <p>The IDOR testing was conducted by:</p>
            <ol>
                <li>Logging into DVWA as regular user (gordonb/abc123)</li>
                <li>Setting security level to "Low"</li>
                <li>Accessing the Authorization Bypass page with manipulated userid parameters</li>
                <li>Analyzing responses for unauthorized data access</li>
                <li>Testing user enumeration capabilities</li>
            </ol>

            <h3>IDOR Vulnerability Pattern</h3>
            <div class="code-block">
<span class="highlight">Vulnerable Request:</span> GET /dvwa/vulnerabilities/authbypass/?userid=<span class="vulnerable">[USER_ID]</span> HTTP/1.1
<span class="highlight">Issue:</span> No server-side authorization check validates if current user can access requested user data
<span class="highlight">Exploitation:</span> Direct manipulation of userid parameter to access any user's information
            </div>

            <h3>Test Results Summary</h3>
            <table>
                <tr>
                    <th>User ID</th>
                    <th>Description</th>
                    <th>Status Code</th>
                    <th>Has User Data</th>
                    <th>Vulnerable</th>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Admin user</td>
                    <td>200</td>
                    <td>Yes</td>
                    <td class="vulnerable">YES</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Gordon user (own account)</td>
                    <td>200</td>
                    <td>Yes</td>
                    <td class="vulnerable">YES</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Hack user</td>
                    <td>200</td>
                    <td>Yes</td>
                    <td class="vulnerable">YES</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Pablo user</td>
                    <td>200</td>
                    <td>Yes</td>
                    <td class="vulnerable">YES</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>Bob user</td>
                    <td>200</td>
                    <td>Yes</td>
                    <td class="vulnerable">YES</td>
                </tr>
                <tr>
                    <td>999</td>
                    <td>Non-existent user</td>
                    <td>200</td>
                    <td>Yes</td>
                    <td class="vulnerable">YES</td>
                </tr>
            </table>
            <h3>Proof of Concept - IDOR Exploitation</h3>
            <p>The following IDOR exploitation attempts were successful:</p>
            <h4>IDOR Exploit 1:</h4>
            <div class="code-block">
<span class="highlight">Attack:</span> Insecure Direct Object Reference (IDOR)
<span class="highlight">Target:</span> Admin user
<span class="highlight">Request:</span> GET /dvwa/vulnerabilities/authbypass/?userid=1 HTTP/1.1
<span class="highlight">Authentication:</span> Regular user session (gordonb/abc123)
<span class="highlight">Status Code:</span> 200
<span class="highlight">Result:</span> Successfully accessed unauthorized user data
<span class="highlight">Vulnerability:</span> Insecure Direct Object Reference (IDOR)
            </div>
            <h4>IDOR Exploit 2:</h4>
            <div class="code-block">
<span class="highlight">Attack:</span> Insecure Direct Object Reference (IDOR)
<span class="highlight">Target:</span> Gordon user (own account)
<span class="highlight">Request:</span> GET /dvwa/vulnerabilities/authbypass/?userid=2 HTTP/1.1
<span class="highlight">Authentication:</span> Regular user session (gordonb/abc123)
<span class="highlight">Status Code:</span> 200
<span class="highlight">Result:</span> Successfully accessed unauthorized user data
<span class="highlight">Vulnerability:</span> Insecure Direct Object Reference (IDOR)
            </div>
            <h4>IDOR Exploit 3:</h4>
            <div class="code-block">
<span class="highlight">Attack:</span> Insecure Direct Object Reference (IDOR)
<span class="highlight">Target:</span> Hack user
<span class="highlight">Request:</span> GET /dvwa/vulnerabilities/authbypass/?userid=3 HTTP/1.1
<span class="highlight">Authentication:</span> Regular user session (gordonb/abc123)
<span class="highlight">Status Code:</span> 200
<span class="highlight">Result:</span> Successfully accessed unauthorized user data
<span class="highlight">Vulnerability:</span> Insecure Direct Object Reference (IDOR)
            </div>
        </div>

        <div class="section">
            <h2>Vulnerability Assessment</h2>
            
            <div class="risk-high">
                <h3>Critical Risk Finding</h3>
                <p>Insecure Direct Object Reference (IDOR) vulnerabilities were identified that allow unauthorized access to user data through manipulation of direct object references.</p>
            </div>
            
            <h3>Attack Scenarios</h3>
            <ol>
                <li><strong>User Enumeration:</strong> Discover valid user IDs through systematic testing</li>
                <li><strong>Data Exposure:</strong> Access unauthorized user information including admin accounts</li>
                <li><strong>Privilege Escalation:</strong> Gain insight into administrative accounts and privileges</li>
                <li><strong>Information Gathering:</strong> Collect user data for further attacks</li>
            </ol>
            
        </div>

        <div class="section">
            <h2>Conclusion</h2>
            
            <p>The testing revealed critical Insecure Direct Object Reference (IDOR) vulnerabilities in DVWA's Authorization Bypass section. The application uses direct object references to access user data without implementing proper server-side authorization checks, allowing any authenticated user to access information belonging to any other user by simply manipulating the userid parameter.</p>
            <p>This represents a fundamental failure in access control implementation and demonstrates the classic IDOR vulnerability pattern where direct manipulation of object identifiers leads to unauthorized data access.</p>
            
        </div>

        <div class="section">
            <h2>Recommendations</h2>
            <ol>
                <li><strong>Implement Server-Side Authorization:</strong> Validate that users can only access data they are authorized to view</li>
                <li><strong>Use Indirect Object References:</strong> Map user-friendly identifiers to internal system identifiers</li>
                <li><strong>Apply Principle of Least Privilege:</strong> Grant users only the minimum required access</li>
                <li><strong>Input Validation:</strong> Validate and sanitize all user-supplied parameters</li>
                <li><strong>Regular Security Testing:</strong> Conduct periodic IDOR vulnerability assessments</li>
            </ol>
        </div>

        <div class="section">
            <h2>Appendices</h2>
            <h3>Tested User IDs</h3>
            <div class="code-block">
?userid=1  # Admin user<br>
?userid=2  # Gordon user (regular)<br>
?userid=3  # Hack user<br>
?userid=4  # Pablo user<br>
?userid=5  # Bob user<br>
?userid=999  # Non-existent user<br>
            </div>
            
            <h3>OWASP IDOR Prevention</h3>
            <ul>
                <li>Use indirect object references (e.g., mapping tables)</li>
                <li>Implement server-side access control checks</li>
                <li>Validate user permissions for each request</li>
                <li>Apply the principle of least privilege</li>
                <li>Use session-based object references where possible</li>
            </ul>
            
            <h3>References</h3>
            <ul>
                <li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/04-Testing_for_Insecure_Direct_Object_References">OWASP Testing Guide - Insecure Direct Object References (OTG-AUTHZ-004)</a></li>
                <li><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top Ten - Broken Access Control</a></li>
                <li><a href="https://owasp.org/www-community/attacks/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet">OWASP IDOR Prevention Cheat Sheet</a></li>
                <li><a href="https://www.dvwa.co.uk/">DVWA Documentation</a></li>
            </ul>
        </div>
    </div>
</body>
</html>