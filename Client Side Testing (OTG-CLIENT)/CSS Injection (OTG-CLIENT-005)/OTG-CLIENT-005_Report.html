<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>OSCP-Style Security Assessment Report</title>
  <style>
    /* OSCP-inspired styling: monospace, dark theme, clean layout */
    body { 
      font-family: 'Courier New', monospace; 
      background: #111; 
      color: #00FF00; 
      padding: 20px; 
      line-height: 1.6;
    }
    .header { text-align: center; margin-bottom: 30px; }
    h1, h2, h3 { color: #00CCFF; border-bottom: 1px solid #00CCFF; padding-bottom: 5px; }
    .section { margin: 20px 0; }
    pre { 
      background: #222; 
      padding: 12px; 
      border-left: 5px solid #00CCFF; 
      overflow-x: auto; 
      font-size: 0.9em;
      color: #FFCC00;
    }
    .evidence { color: #FFCC00; font-weight: bold; }
    .recommendation { color: #AAFF00; }
    .vulnerable { color: #FF5555; font-weight: bold; }
    .safe { color: #55FF55; }
    footer { margin-top: 60px; font-size: 0.8em; text-align: center; color: #666; }
    code { background: #333; padding: 2px 4px; border-radius: 3px; }
  </style>
</head>
<body>
  <div class="header">
    <h1>Security Assessment Report</h1>
    <p><strong>Test ID:</strong> OTG-CLIENT-005</p>
    <p><strong>Vulnerability:</strong> CSS Injection</p>
    <p><strong>Target:</strong> http://localhost/dvwa/</p>
    <p><strong>Date:</strong> 2025-08-02 02:43:41</p>
  </div>

  <div class="section">
    <h2>1. Test Overview</h2>
    <p><strong>Objective:</strong> Detect and verify CSS injection vulnerabilities in user input fields.</p>
    <p><strong>OWASP Reference:</strong> OTG-CLIENT-005</p>
    <p><strong>Description:</strong> CSS Injection occurs when user input is embedded in CSS contexts without proper sanitization, allowing attackers to manipulate page styling and potentially extract information.</p>
  </div>

  <div class="section">
    <h2>2. Test Procedure</h2>
    <p>1. Authenticate to DVWA using provided credentials.</p>
    <p>2. Set security level to <strong>Low</strong>.</p>
    <p>3. Navigate to vulnerable input forms (e.g., XSS Reflected/Stores).</p>
    <p>4. Inject CSS payloads such as <code>&lt;style&gt;</code>, <code>style=&quot;&quot;</code> attributes.</p>
    <p>5. Capture server responses and DOM state.</p>
    <p>6. Verify visual rendering via browser automation.</p>
  </div>

  <div class="section">
    <h2>3. Findings</h2>
    <h3>Reflected CSS Injection</h3>
    <p><strong>Status:</strong> <span class="vulnerable">
        Vulnerable
    </span></p>
    <p><strong>Payload Used:</strong> <code>&lt;style&gt;body { background-color: red !important; }&lt;/style&gt;</code></p>
    <pre>Style tag payload reflected in response. URL: http://localhost/dvwa/vulnerabilities/xss_r/?name=%3Cstyle%3Ebody%20%7B%20background-color%3A%20red%20%21important%3B%20%7D%3C/style%3E</pre>
    <p class="evidence"><strong>Evidence:</strong> CSS payload rendered in response.</p>

    <h3>Stored CSS Injection</h3>
    <p><strong>Status:</strong> <span class="vulnerable">
        Vulnerable
    </span></p>
    <p><strong>Payload Used:</strong> <code>&lt;p style=&quot;color: blue; font-weight: bold;&quot;&gt;Stored CSS Injection Test&lt;/p&gt;</code></p>
    <pre>CSS payload stored in guestbook</pre>
    <p class="evidence"><strong>Evidence:</strong> CSS payload stored and rendered on page reload.</p>
  </div>

  <div class="section">
    <h2>4. Impact</h2>
    <p>An attacker can alter the visual appearance of the web page, potentially leading to UI redressing, phishing, or information disclosure through CSS pseudo-selectors. While less severe than XSS, it can be used in conjunction with other vulnerabilities.</p>
  </div>

  <div class="section">
    <h2>5. Recommendations</h2>
    <p class="recommendation">- Sanitize user inputs to remove or encode CSS-related keywords and tags.</p>
    <p class="recommendation">- Implement proper output encoding based on context (HTML, CSS, attribute).</p>
    <p class="recommendation">- Use Content Security Policy (CSP) to restrict inline styles and external stylesheets.</p>
    <p class="recommendation">- Avoid using user input in style attributes or style blocks.</p>
    <p class="recommendation">- Validate and filter input for CSS-specific patterns (e.g., {, }, style=, <style>).</p>
    <p class="recommendation">- Implement CSRF protection tokens for all forms.</p>
  </div>

  <footer>
    &copy; 2025 Automated Security Testing Framework. Report generated by AI Agent.
  </footer>
</body>
</html>