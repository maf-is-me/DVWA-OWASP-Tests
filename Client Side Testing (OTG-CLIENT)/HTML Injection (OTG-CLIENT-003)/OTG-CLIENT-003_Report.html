<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>OSCP-Style Security Assessment Report</title>
  <style>
    /* OSCP-inspired styling: monospace, dark theme, clean layout */
    body { 
      font-family: 'Courier New', monospace; 
      background: #111; 
      color: #00FF00; 
      padding: 20px; 
      line-height: 1.6;
    }
    .header { text-align: center; margin-bottom: 30px; }
    h1, h2, h3 { color: #00CCFF; border-bottom: 1px solid #00CCFF; padding-bottom: 5px; }
    .section { margin: 20px 0; }
    pre { 
      background: #222; 
      padding: 12px; 
      border-left: 5px solid #00CCFF; 
      overflow-x: auto; 
      font-size: 0.9em;
      color: #FFCC00;
    }
    .evidence { color: #FFCC00; font-weight: bold; }
    .recommendation { color: #AAFF00; }
    .vulnerable { color: #FF5555; font-weight: bold; }
    .safe { color: #55FF55; }
    footer { margin-top: 60px; font-size: 0.8em; text-align: center; color: #666; }
    code { background: #333; padding: 2px 4px; border-radius: 3px; }
  </style>
</head>
<body>
  <div class="header">
    <h1>Security Assessment Report</h1>
    <p><strong>Test ID:</strong> OTG-CLIENT-003</p>
    <p><strong>Vulnerability:</strong> HTML Injection</p>
    <p><strong>Target:</strong> http://localhost/dvwa/</p>
    <p><strong>Date:</strong> 2025-08-02 02:29:20</p>
  </div>

  <div class="section">
    <h2>1. Test Overview</h2>
    <p><strong>Objective:</strong> Detect and verify HTML injection vulnerabilities in user input fields.</p>
    <p><strong>OWASP Reference:</strong> OTG-CLIENT-003</p>
    <p><strong>Description:</strong> HTML Injection occurs when user input is embedded in the page output without proper sanitization, allowing attackers to inject visible HTML content.</p>
  </div>

  <div class="section">
    <h2>2. Test Procedure</h2>
    <p>1. Authenticate to DVWA using provided credentials.</p>
    <p>2. Set security level to <strong>Low</strong>.</p>
    <p>3. Navigate to vulnerable input forms (e.g., XSS Reflected/Stores).</p>
    <p>4. Inject HTML payloads such as <code>&lt;h1&gt;</code>, <code>&lt;b&gt;</code>, <code>&lt;img&gt;</code>.</p>
    <p>5. Capture server responses and DOM state.</p>
    <p>6. Verify rendering via browser automation.</p>
  </div>

  <div class="section">
    <h2>3. Findings</h2>
    <h3>Reflected HTML Injection</h3>
    <p><strong>Status:</strong> <span class="vulnerable">
        Vulnerable
    </span></p>
    <p><strong>Payload Used:</strong> <code>&lt;h1 style=&quot;color:red;&quot;&gt;INJECTED HTML&lt;/h1&gt;</code></p>
    <pre>HTML payload reflected in response. URL: http://localhost/dvwa/vulnerabilities/xss_r/?name=%3Ch1%20style%3D%22color%3Ared%3B%22%3EINJECTED%20HTML%3C/h1%3E</pre>
    <p class="evidence"><strong>Evidence:</strong> HTML payload rendered in response.</p>

    <h3>Stored HTML Injection</h3>
    <p><strong>Status:</strong> <span class="vulnerable">
        Vulnerable
    </span></p>
    <p><strong>Payload Used:</strong> <code>&lt;b&gt;Bold Text via Injection&lt;/b&gt;</code></p>
    <pre>HTML payload stored in guestbook</pre>
    <p class="evidence"><strong>Evidence:</strong> HTML payload stored and rendered on page reload.</p>
  </div>

  <div class="section">
    <h2>4. Impact</h2>
    <p>An attacker can alter the visual appearance of the web page, potentially misleading users, injecting fake forms, or redirecting clicks. While less severe than XSS, it can be used for phishing and UI redressing.</p>
  </div>

  <div class="section">
    <h2>5. Recommendations</h2>
    <p class="recommendation">- Sanitize all user inputs using libraries like DOMPurify or OWASP Java Encoder.</p>
    <p class="recommendation">- Implement proper output encoding based on context (HTML, HTML attribute, JS, CSS, URL).</p>
    <p class="recommendation">- Use Content Security Policy (CSP) to restrict inline scripts and unauthorized resources.</p>
    <p class="recommendation">- Validate input length, format, and allowed HTML tags if rich text is required.</p>
    <p class="recommendation">- Implement CSRF protection tokens for all forms.</p>
  </div>

  <footer>
    &copy; 2025 Automated Security Testing Framework. Report generated by AI Agent.
  </footer>
</body>
</html>